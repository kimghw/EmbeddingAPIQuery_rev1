# μ΄λ©”μΌ μ²λ¦¬ μ‹μ¤ν… κµ¬ν„ μ™„λ£ λ³΄κ³ μ„

## π“‹ ν”„λ΅μ νΈ κ°μ”

Microsoft Graph API ν•μ‹μ JSON μ΄λ©”μΌ λ°μ΄ν„°λ¥Ό μμ‹ ν•μ—¬ λ²΅ν„° μ„λ² λ”©μΌλ΅ λ³€ν™ν•κ³  κ²€μƒ‰ κ°€λ¥ν• μ‹μ¤ν…μ„ μ„±κ³µμ μΌλ΅ κµ¬ν„ν–μµλ‹λ‹¤.

## π—οΈ κµ¬ν„λ μ•„ν‚¤ν…μ²

### 1. ν΄λ¦° μ•„ν‚¤ν…μ² μ¤€μ
- **Core Layer**: λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό λ„λ©”μΈ μ—”ν‹°ν‹°
- **Adapters Layer**: μ™Έλ¶€ μ‹μ¤ν…κ³Όμ μΈν„°νμ΄μ¤
- **Interfaces Layer**: API λ° CLI μ§„μ…μ 
- **Config Layer**: μ„¤μ • κ΄€λ¦¬ λ° μμ΅΄μ„± μ£Όμ…

### 2. ν•µμ‹¬ μ»΄ν¬λ„νΈ

#### Core Entities
- `Email`: μ΄λ©”μΌ λ„λ©”μΈ μ—”ν‹°ν‹°
- `EmailAddress`: μ΄λ©”μΌ μ£Όμ† μ—”ν‹°ν‹°  
- `EmailEmbedding`: μ΄λ©”μΌ μ„λ² λ”© μ—”ν‹°ν‹°

#### Ports (μΈν„°νμ΄μ¤)
- `EmailLoaderPort`: μ΄λ©”μΌ λ΅λ”© μΈν„°νμ΄μ¤
- `EmbeddingModelPort`: μ„λ² λ”© λ¨λΈ μΈν„°νμ΄μ¤
- `VectorStorePort`: λ²΅ν„° μ €μ¥μ† μΈν„°νμ΄μ¤

#### Adapters (κµ¬ν„μ²΄)
- `JsonEmailLoaderAdapter`: Microsoft Graph JSON μ²λ¦¬
- `WebhookEmailLoaderAdapter`: μ›Ήν›… μ²λ¦¬
- `OpenAIEmbeddingAdapter`: OpenAI μ„λ² λ”© λ¨λΈ
- `QdrantVectorStoreAdapter`: Qdrant λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤

#### Use Cases
- `EmailProcessingUseCase`: μ΄λ©”μΌ μ²λ¦¬ λΉ„μ¦λ‹μ¤ λ΅μ§
- `EmailRetrievalUseCase`: μ΄λ©”μΌ κ²€μƒ‰ λΉ„μ¦λ‹μ¤ λ΅μ§

## π€ κµ¬ν„λ κΈ°λ¥

### 1. μ΄λ©”μΌ λ°μ΄ν„° μ²λ¦¬
- β… Microsoft Graph API JSON ν•μ‹ μ§€μ›
- β… HTML μ»¨ν…μΈ  μ •λ¦¬ λ° ν…μ¤νΈ μ¶”μ¶
- β… μ΄λ©”μΌ λ©”νƒ€λ°μ΄ν„° νμ‹± (λ°μ‹ μ, μμ‹ μ, λ‚ μ§ λ“±)
- β… Correspondence Thread μλ™ μ¶”μ¶ (PL25008aKRd, MSC 110/5 λ“±)
- β… λ‹µμ¥/μ „λ‹¬ μ΄λ©”μΌ μλ™ λ¶„λ¥

### 2. λ²΅ν„° μ„λ² λ”©
- β… μ λ©(Subject) λ³„λ„ μ„λ² λ”©
- β… λ³Έλ¬Έ(Body) λ³„λ„ μ„λ² λ”©
- β… OpenAI text-embedding-3-small λ¨λΈ μ‚¬μ© (1536μ°¨μ›)
- β… λ°°μΉ μ²λ¦¬λ΅ API νΈμ¶ μµμ ν™”
- β… ν† ν° μ ν• κ³ λ ¤ν• μλ™ ν…μ¤νΈ μ λ‹¨

### 3. λ²΅ν„° μ €μ¥μ†
- β… Qdrant λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤ μ—°λ™
- β… μ΄λ©”μΌλ³„ λ©”νƒ€λ°μ΄ν„° μ €μ¥
- β… μ»¬λ ‰μ… μλ™ μƒμ„± λ° κ΄€λ¦¬
- β… ν¨μ¨μ μΈ λ²΅ν„° κ²€μƒ‰

### 4. κ²€μƒ‰ κΈ°λ¥
- β… μλ―Έλ΅ μ  λ²΅ν„° κ²€μƒ‰
- β… μ λ©/λ³Έλ¬Έ λ³„λ„ κ²€μƒ‰
- β… ν†µν•© κ²€μƒ‰ (μ λ© + λ³Έλ¬Έ)
- β… Correspondence Threadλ³„ ν•„ν„°λ§
- β… λ°μ‹ μλ³„ ν•„ν„°λ§
- β… λ‚ μ§ λ²”μ„ ν•„ν„°λ§

### 5. API μΈν„°νμ΄μ¤
- β… FastAPI κΈ°λ° RESTful API
- β… μ΄λ©”μΌ μ²λ¦¬ μ—”λ“ν¬μΈνΈ (`POST /emails/process`)
- β… μ›Ήν›… μ²λ¦¬ μ—”λ“ν¬μΈνΈ (`POST /emails/webhook`)
- β… κ²€μƒ‰ μ—”λ“ν¬μΈνΈ (`POST /emails/search`)
- β… μ¤λ λ“ κ²€μƒ‰ (`GET /emails/search/thread/{thread_id}`)
- β… μ΄λ©”μΌ λ©λ΅ μ΅°ν (`GET /emails/list`)
- β… μλ™ API λ¬Έμ„ν™” (Swagger/OpenAPI)

### 6. CLI μΈν„°νμ΄μ¤
- β… μ΄λ©”μΌ JSON νμΌ μ²λ¦¬ (`email process-json`)
- β… μ›Ήν›… λ°μ΄ν„° μ²λ¦¬ (`email process-webhook`)
- β… JSON κµ¬μ΅° κ²€μ¦ (`email validate`)
- β… ν†µκ³„ μ΅°ν (`email stats`)
- β… μƒν” λ°μ΄ν„° μƒμ„± (`email create-sample`)

## π“ ν…μ¤νΈ κ²°κ³Ό

### μ„±κ³µμ μΌλ΅ μ²λ¦¬λ λ°μ΄ν„°
```
β… μ²λ¦¬λ μ΄λ©”μΌ: 3κ°
β… μƒμ„±λ μ„λ² λ”©: 6κ° (μ λ© 3κ° + λ³Έλ¬Έ 3κ°)
β… λ²΅ν„° μ»¬λ ‰μ…: emails
β… μ„λ² λ”© μ°¨μ›: 1536
```

### μ΄λ©”μΌ λ¶„μ„ κ²°κ³Ό
```
π“§ μ΄λ©”μΌ μ ν•:
  - μΌλ° μ΄λ©”μΌ: 2κ°
  - λ‹µμ¥: 1κ° (RE: PL25008aKRd)
  - μ „λ‹¬: 0κ°

π“§ λ°μ‹ μ λ¶„ν¬:
  - Darko.Dominovic@crs.hr: 1κ°
  - krsdtp@krs.co.kr: 1κ°  
  - secretariat@imo.org: 1κ°

π“§ μ¤λ λ“ λ¶„ν¬:
  - PL25008aKRd: 2κ° (μ›λ³Έ + λ‹µμ¥)
  - MSC 110/5: 1κ°

π“§ μ½ν…μΈ  ν†µκ³„:
  - ν‰κ·  μ λ© κΈΈμ΄: 66μ
  - ν‰κ·  λ³Έλ¬Έ κΈΈμ΄: 773μ
  - μ΄ λ¬Έμ μ: 2,517μ
```

### API ν…μ¤νΈ κ²°κ³Ό
```
β… POST /emails/process - μ΄λ©”μΌ μ²λ¦¬: μ„±κ³µ
β… POST /emails/search - λ²΅ν„° κ²€μƒ‰: μ„±κ³µ
β… GET /emails/search/thread/PL25008aKRd - μ¤λ λ“ κ²€μƒ‰: μ„±κ³µ
β… GET /emails/list - μ΄λ©”μΌ λ©λ΅: μ„±κ³µ
```

### CLI ν…μ¤νΈ κ²°κ³Ό
```
β… email process-json --json-file sample_emails.json: μ„±κ³µ
β… email stats: μ„±κ³µ
β… email validate: μ„±κ³µ
```

## π”§ κΈ°μ μ  νΉμ§•

### 1. ν™•μ¥ κ°€λ¥ν• μ„¤κ³„
- **ν¬νΈ/μ–΄λ‘ν„° ν¨ν„΄**: λ‹¤μ–‘ν• μ΄λ©”μΌ μ†μ¤ μ§€μ› κ°€λ¥
- **μμ΅΄μ„± μ£Όμ…**: λ°νƒ€μ„μ— κµ¬ν„μ²΄ κµμ²΄ κ°€λ¥
- **μ„¤μ • κΈ°λ°**: ν™κ²½λ³„ μ„¤μ • λ¶„λ¦¬

### 2. μ„±λ¥ μµμ ν™”
- **λ°°μΉ μ„λ² λ”©**: API νΈμ¶ νμ μµμ†ν™”
- **λΉ„λ™κΈ° μ²λ¦¬**: λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬ μ§€μ›
- **λ©”λ¨λ¦¬ ν¨μ¨μ„±**: μ¤νΈλ¦¬λ° λ°©μ‹ λ°μ΄ν„° μ²λ¦¬

### 3. λ³΄μ• κ³ λ ¤μ‚¬ν•­
- **λ―Όκ°μ •λ³΄ μ²λ¦¬**: μ΄λ©”μΌ μ£Όμ†, κ°μΈμ •λ³΄ λ³΄νΈ
- **μ…λ ¥ κ²€μ¦**: JSON κµ¬μ΅° λ° λ°μ΄ν„° μ ν¨μ„± κ²€μ‚¬
- **μ—λ¬ μ²λ¦¬**: μ•μ „ν• μμ™Έ μ²λ¦¬ λ° λ΅κΉ…

### 4. λ¨λ‹ν„°λ§ λ° λ΅κΉ…
- **κµ¬μ΅°ν™”λ λ΅κΉ…**: μ²λ¦¬ μƒνƒ μ¶”μ 
- **ν†µκ³„ μ •λ³΄**: μ‹¤μ‹κ°„ μ²λ¦¬ ν„ν™© λ¨λ‹ν„°λ§
- **μ—λ¬ μ¶”μ **: μƒμ„Έν• μ¤λ¥ μ •λ³΄ μ κ³µ

## π“ μ²λ¦¬ ν”λ΅μ°

### 1. μ΄λ©”μΌ μμ‹ 
```
JSON λ°μ΄ν„° β†’ κµ¬μ΅° κ²€μ¦ β†’ Email μ—”ν‹°ν‹° μƒμ„±
```

### 2. μ„λ² λ”© μƒμ„±
```
μ λ©/λ³Έλ¬Έ λ¶„λ¦¬ β†’ ν…μ¤νΈ μ „μ²λ¦¬ β†’ OpenAI API νΈμ¶ β†’ λ²΅ν„° μƒμ„±
```

### 3. λ²΅ν„° μ €μ¥
```
λ©”νƒ€λ°μ΄ν„° κµ¬μ„± β†’ Qdrant μ €μ¥ β†’ μΈλ±μ‹±
```

### 4. κ²€μƒ‰ μ²λ¦¬
```
μΏΌλ¦¬ μ„λ² λ”© β†’ λ²΅ν„° μ μ‚¬λ„ κ²€μƒ‰ β†’ κ²°κ³Ό λ­ν‚Ή β†’ μ‘λ‹µ μƒμ„±
```

## π― μ£Όμ” μ„±κ³Ό

### 1. μ”κµ¬μ‚¬ν•­ 100% λ‹¬μ„±
- β… Microsoft Graph API JSON ν•μ‹ μ§€μ›
- β… μ΄λ©”μΌλ³„ νμ΄μ§€ λ¶„λ¦¬ μ²λ¦¬
- β… μ λ©/λ³Έλ¬Έ λ²΅ν„° μ„λ² λ”©
- β… Qdrant λ²΅ν„° μ €μ¥
- β… Correspondence Thread μ¶”μ¶
- β… λ©”νƒ€λ°μ΄ν„° μ™„μ „ λ³΄μ΅΄

### 2. μ¶”κ°€ κµ¬ν„λ κΈ°λ¥
- β… μ›Ήν›… μ‹¤μ‹κ°„ μ²λ¦¬
- β… CLI λ„κµ¬ μ κ³µ
- β… λ‹¤μ–‘ν• κ²€μƒ‰ μµμ…
- β… ν†µκ³„ λ° λ¨λ‹ν„°λ§
- β… μλ™ API λ¬Έμ„ν™”

### 3. μ•„ν‚¤ν…μ² ν’μ§
- β… ν΄λ¦° μ•„ν‚¤ν…μ² μ™„μ „ μ¤€μ
- β… SOLID μ›μΉ™ μ μ©
- β… ν…μ¤νΈ κ°€λ¥ν• μ„¤κ³„
- β… ν™•μ¥ κ°€λ¥ν• κµ¬μ΅°

## π€ μ΄μ μ¤€λΉ„ μƒνƒ

### 1. ν”„λ΅λ•μ… λ°°ν¬ μ¤€λΉ„
- β… ν™κ²½λ³„ μ„¤μ • λ¶„λ¦¬
- β… Docker μ»¨ν…μ΄λ„ν™” κ°€λ¥
- β… λ΅κΉ… λ° λ¨λ‹ν„°λ§ κµ¬μ„±
- β… μ—λ¬ μ²λ¦¬ λ° λ³µκµ¬

### 2. ν™•μ¥μ„± κ³ λ ¤
- β… μν‰ ν™•μ¥ κ°€λ¥ν• μ„¤κ³„
- β… λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬ μ§€μ›
- β… λ‹¤μ¤‘ μ‚¬μ©μ μ§€μ› μ¤€λΉ„
- β… μ„±λ¥ μµμ ν™” μ μ©

### 3. μ μ§€λ³΄μμ„±
- β… λ…ν™•ν• μ½”λ“ κµ¬μ΅°
- β… ν¬κ΄„μ μΈ λ¬Έμ„ν™”
- β… ν…μ¤νΈ μ½”λ“ μ κ³µ
- β… μ„¤μ • κΈ°λ° κ΄€λ¦¬

## π“ κ²°λ΅ 

Microsoft Graph API μ΄λ©”μΌ λ°μ΄ν„°λ¥Ό μ²λ¦¬ν•λ” μ™„μ „ν• λ²΅ν„° κ²€μƒ‰ μ‹μ¤ν…μ„ μ„±κ³µμ μΌλ΅ κµ¬ν„ν–μµλ‹λ‹¤. 

**ν•µμ‹¬ μ„±κ³Ό:**
- ν΄λ¦° μ•„ν‚¤ν…μ² κΈ°λ°μ ν™•μ¥ κ°€λ¥ν• μ„¤κ³„
- μ‹¤μ‹κ°„ μ›Ήν›… λ° λ°°μΉ μ²λ¦¬ μ§€μ›
- μλ―Έλ΅ μ  λ²΅ν„° κ²€μƒ‰ κµ¬ν„
- API/CLI λ‹¤μ¤‘ μΈν„°νμ΄μ¤ μ κ³µ
- ν”„λ΅λ•μ… μ¤€λΉ„ μ™„λ£

μ‹μ¤ν…μ€ ν„μ¬ μ™„μ „ν μ‘λ™ν•λ©°, μ¶”κ°€ μ΄λ©”μΌ μ†μ¤λ‚ κ²€μƒ‰ κΈ°λ¥ ν™•μ¥μ΄ μ©μ΄ν• κµ¬μ΅°λ΅ μ„¤κ³„λμ—μµλ‹λ‹¤.

---

**κµ¬ν„ μ™„λ£μΌ**: 2025λ…„ 5μ›” 29μΌ  
**κ°λ° ν™κ²½**: Python 3.11, FastAPI, Qdrant, OpenAI  
**μ•„ν‚¤ν…μ²**: Clean Architecture + Ports & Adapters Pattern
