# π“‹ ν”„λ΅μ νΈ κ°μ” λ° μ•„ν‚¤ν…μ²

## π― ν”„λ΅μ νΈ λ©ν‘

**EmbeddingAPIQuery**λ” λ¬Έμ„ μ„λ² λ”© λ° κ²€μƒ‰ μ‹μ¤ν…μΌλ΅, λ‹¤μ–‘ν• ν•νƒμ λ¬Έμ„(PDF, JSON, μ›Ή νμ΄μ§€ λ“±)λ¥Ό λ²΅ν„°ν™”ν•μ—¬ μλ―Έ κΈ°λ° κ²€μƒ‰μ„ μ κ³µν•λ” FastAPI κΈ°λ° μ‹μ¤ν…μ…λ‹λ‹¤.

### ν•µμ‹¬ κΈ°λ¥
- π“„ **λ‹¤μ–‘ν• λ¬Έμ„ ν•μ‹ μ§€μ›**: PDF, JSON, μ›Ή μ¤ν¬λν•‘
- π§  **μ„λ² λ”© μƒμ„±**: OpenAI, λ΅μ»¬ λ¨λΈ μ§€μ›
- π” **λ²΅ν„° κ²€μƒ‰**: Qdrant, FAISS, Mock λ²΅ν„° μ¤ν† μ–΄
- π“§ **μ΄λ©”μΌ μ‹μ¤ν…**: Microsoft Graph API μ΄λ©”μΌ μ²λ¦¬
- π”„ **μ–΄λ‘ν„° ν¨ν„΄**: μ μ—°ν• κµ¬μ„± μ”μ† κµμ²΄
- π **λ‹¤μ¤‘ μΈν„°νμ΄μ¤**: REST API, CLI

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

### ν΄λ¦° μ•„ν‚¤ν…μ² κΈ°λ° μ„¤κ³„

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    Interfaces Layer                         β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚   FastAPI       β”‚    β”‚         CLI                     β”‚ β”‚
β”‚  β”‚   REST API      β”‚    β”‚      Commands                   β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                              β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                   Adapters Layer                            β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚   Vector    β”‚ β”‚  Embedding  β”‚ β”‚      Document           β”‚ β”‚
β”‚  β”‚   Stores    β”‚ β”‚   Models    β”‚ β”‚      Loaders            β”‚ β”‚
β”‚  β”‚             β”‚ β”‚             β”‚ β”‚                         β”‚ β”‚
β”‚  β”‚ β€Ά Qdrant    β”‚ β”‚ β€Ά OpenAI    β”‚ β”‚ β€Ά PDF                   β”‚ β”‚
β”‚  β”‚ β€Ά FAISS     β”‚ β”‚ β€Ά Local     β”‚ β”‚ β€Ά JSON                  β”‚ β”‚
β”‚  β”‚ β€Ά Mock      β”‚ β”‚             β”‚ β”‚ β€Ά Web Scraper           β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                              β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     Core Layer                              β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚   Use Cases     β”‚    β”‚           Entities              β”‚ β”‚
β”‚  β”‚                 β”‚    β”‚                                 β”‚ β”‚
β”‚  β”‚ β€Ά Document      β”‚    β”‚ β€Ά Document                      β”‚ β”‚
β”‚  β”‚   Processing    β”‚    β”‚ β€Ά Embedding                     β”‚ β”‚
β”‚  β”‚ β€Ά Document      β”‚    β”‚ β€Ά Email                         β”‚ β”‚
β”‚  β”‚   Retrieval     β”‚    β”‚ β€Ά RetrievalResult               β”‚ β”‚
β”‚  β”‚ β€Ά Email         β”‚    β”‚                                 β”‚ β”‚
β”‚  β”‚   Processing    β”‚    β”‚                                 β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚                                                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚                    Ports                                β”‚ β”‚
β”‚  β”‚ β€Ά DocumentLoaderPort  β€Ά EmbeddingModelPort              β”‚ β”‚
β”‚  β”‚ β€Ά VectorStorePort     β€Ά TextChunkerPort                 β”‚ β”‚
β”‚  β”‚ β€Ά EmailLoaderPort     β€Ά RetrieverPort                   β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### ν•µμ‹¬ μ„¤κ³„ μ›μΉ™

1. **μμ΅΄μ„± μ—­μ „ (Dependency Inversion)**
   - Coreλ” μ™Έλ¶€ κµ¬ν„μ— μμ΅΄ν•μ§€ μ•μ
   - Port/Adapter ν¨ν„΄μΌλ΅ μ¶”μƒν™”

2. **λ‹¨μΌ μ±…μ„ μ›μΉ™ (Single Responsibility)**
   - κ° μ»΄ν¬λ„νΈλ” ν•λ‚μ λ…ν™•ν• μ±…μ„
   - μ μ¤μΌ€μ΄μ¤λ³„ λ¶„λ¦¬λ λ΅μ§

3. **κ°λ°©-νμ‡„ μ›μΉ™ (Open-Closed)**
   - μƒλ΅μ΄ μ–΄λ‘ν„° μ¶”κ°€ μ‹ κΈ°μ΅΄ μ½”λ“ μμ • λ¶ν•„μ”
   - μ„¤μ •μ„ ν†µν• λ°νƒ€μ„ κµ¬μ„± λ³€κ²½

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
EmbeddingAPIQuery_rev1/
β”β”€β”€ core/                    # ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§
β”‚   β”β”€β”€ entities/           # λ„λ©”μΈ μ—”ν‹°ν‹°
β”‚   β”β”€β”€ ports/              # μΈν„°νμ΄μ¤ μ •μ
β”‚   β”β”€β”€ usecases/           # λΉ„μ¦λ‹μ¤ μ μ¤μΌ€μ΄μ¤
β”‚   β””β”€β”€ services/           # λ„λ©”μΈ μ„λΉ„μ¤
β”β”€β”€ adapters/               # μ™Έλ¶€ μ‹μ¤ν… μ—°λ™
β”‚   β”β”€β”€ embedding/          # μ„λ² λ”© λ¨λΈ μ–΄λ‘ν„°
β”‚   β”β”€β”€ vector_store/       # λ²΅ν„° μ¤ν† μ–΄ μ–΄λ‘ν„°
β”‚   β”β”€β”€ pdf/                # λ¬Έμ„ λ΅λ” μ–΄λ‘ν„°
β”‚   β””β”€β”€ email/              # μ΄λ©”μΌ λ΅λ” μ–΄λ‘ν„°
β”β”€β”€ interfaces/             # μ™Έλ¶€ μΈν„°νμ΄μ¤
β”‚   β”β”€β”€ api/                # FastAPI λΌμ°ν„°
β”‚   β””β”€β”€ cli/                # CLI λ…λ Ήμ–΄
β”β”€β”€ config/                 # μ„¤μ • κ΄€λ¦¬
β”β”€β”€ schemas/                # Pydantic μ¤ν‚¤λ§
β”β”€β”€ tests/                  # ν…μ¤νΈ μ½”λ“
β””β”€β”€ docs/                   # λ¬Έμ„
```

## π”§ μ£Όμ” μ»΄ν¬λ„νΈ

### 1. Core Layer

#### Entities (μ—”ν‹°ν‹°)
- **Document**: λ¬Έμ„ λ©”νƒ€λ°μ΄ν„° λ° λ‚΄μ©
- **Embedding**: λ²΅ν„° μ„λ² λ”© μ •λ³΄
- **Email**: μ΄λ©”μΌ λ°μ΄ν„° κµ¬μ΅°
- **RetrievalResult**: κ²€μƒ‰ κ²°κ³Ό

#### Use Cases (μ μ¤μΌ€μ΄μ¤)
- **DocumentProcessingUseCase**: λ¬Έμ„ μ²λ¦¬ νμ΄ν”„λΌμΈ
- **DocumentRetrievalUseCase**: λ¬Έμ„ κ²€μƒ‰ λ΅μ§
- **EmailProcessingUseCase**: μ΄λ©”μΌ μ²λ¦¬ νμ΄ν”„λΌμΈ

#### Ports (ν¬νΈ)
- **DocumentLoaderPort**: λ¬Έμ„ λ΅λ”© μΈν„°νμ΄μ¤
- **EmbeddingModelPort**: μ„λ² λ”© λ¨λΈ μΈν„°νμ΄μ¤
- **VectorStorePort**: λ²΅ν„° μ¤ν† μ–΄ μΈν„°νμ΄μ¤
- **EmailLoaderPort**: μ΄λ©”μΌ λ΅λ” μΈν„°νμ΄μ¤

### 2. Adapters Layer

#### Vector Stores
- **QdrantVectorStoreAdapter**: Qdrant λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤
- **FAISSVectorStoreAdapter**: FAISS λ΅μ»¬ λ²΅ν„° μ¤ν† μ–΄
- **MockVectorStoreAdapter**: ν…μ¤νΈμ© Mock μ¤ν† μ–΄

#### Embedding Models
- **OpenAIEmbeddingAdapter**: OpenAI API μ„λ² λ”©
- **SemanticTextChunkerAdapter**: μλ―Έ κΈ°λ° ν…μ¤νΈ λ¶„ν• 

#### Document Loaders
- **PDFLoaderAdapter**: PDF λ¬Έμ„ μ²λ¦¬
- **JSONLoaderAdapter**: JSON λ°μ΄ν„° μ²λ¦¬
- **WebScraperLoaderAdapter**: μ›Ή νμ΄μ§€ μ¤ν¬λν•‘

#### Email Loaders
- **JsonEmailLoaderAdapter**: Microsoft Graph JSON μ²λ¦¬
- **WebhookEmailLoaderAdapter**: μ‹¤μ‹κ°„ μ›Ήν›… μ²λ¦¬

### 3. Interfaces Layer

#### REST API
- **Document API**: λ¬Έμ„ μ—…λ΅λ“ λ° κ²€μƒ‰
- **Email API**: μ΄λ©”μΌ μ²λ¦¬ λ° κ²€μƒ‰
- **Chat API**: λ€ν™”ν• κ²€μƒ‰ μΈν„°νμ΄μ¤

#### CLI
- **Document Commands**: λ¬Έμ„ κ΄€λ ¨ CLI λ…λ Ή
- **Email Commands**: μ΄λ©”μΌ κ΄€λ ¨ CLI λ…λ Ή

## π”„ λ°μ΄ν„° ν”λ΅μ°

### λ¬Έμ„ μ²λ¦¬ ν”λ΅μ°
```
1. λ¬Έμ„ μ—…λ΅λ“ (PDF/JSON/URL)
   β†“
2. λ¬Έμ„ λ΅λ”λ΅ ν…μ¤νΈ μ¶”μ¶
   β†“
3. ν…μ¤νΈ μ²­ν‚Ή (μλ―Έ λ‹¨μ„ λ¶„ν• )
   β†“
4. μ„λ² λ”© λ¨λΈλ΅ λ²΅ν„° μƒμ„±
   β†“
5. λ²΅ν„° μ¤ν† μ–΄μ— μ €μ¥
```

### κ²€μƒ‰ ν”λ΅μ°
```
1. μ‚¬μ©μ μΏΌλ¦¬ μ…λ ¥
   β†“
2. μΏΌλ¦¬ μ„λ² λ”© μƒμ„±
   β†“
3. λ²΅ν„° μ μ‚¬λ„ κ²€μƒ‰
   β†“
4. κ²°κ³Ό λ­ν‚Ή λ° ν•„ν„°λ§
   β†“
5. κ²€μƒ‰ κ²°κ³Ό λ°ν™
```

### μ΄λ©”μΌ μ²λ¦¬ ν”λ΅μ°
```
1. Microsoft Graph JSON μμ‹ 
   β†“
2. μ΄λ©”μΌ μ—”ν‹°ν‹° νμ‹±
   β†“
3. μ λ©/λ³Έλ¬Έ μ„λ² λ”© μƒμ„±
   β†“
4. λ²΅ν„° μ¤ν† μ–΄μ— μ €μ¥
   β†“
5. κ²€μƒ‰ κ°€λ¥ν• μƒνƒ
```

## π― ν•µμ‹¬ νΉμ§•

### 1. μ μ—°ν• κµ¬μ„±
- **λ°νƒ€μ„ μ–΄λ‘ν„° κµμ²΄**: μ„¤μ • νμΌλ΅ κµ¬μ„± μ”μ† λ³€κ²½
- **λ‹¤μ¤‘ λ²΅ν„° μ¤ν† μ–΄**: Qdrant, FAISS λ™μ‹ μ§€μ›
- **λ‹¤μ–‘ν• μ„λ² λ”© λ¨λΈ**: OpenAI, λ΅μ»¬ λ¨λΈ μ§€μ›

### 2. ν™•μ¥μ„±
- **μƒλ΅μ΄ μ–΄λ‘ν„° μ¶”κ°€**: κΈ°μ΅΄ μ½”λ“ μμ • μ—†μ΄ ν™•μ¥
- **λ§μ΄ν¬λ΅μ„λΉ„μ¤ μ¤€λΉ„**: λ…λ¦½μ μΈ μ»΄ν¬λ„νΈ κµ¬μ΅°
- **μν‰ ν™•μ¥**: λ²΅ν„° μ¤ν† μ–΄ ν΄λ¬μ¤ν„°λ§ μ§€μ›

### 3. μ•μ •μ„±
- **μ—λ¬ μ²λ¦¬**: κ° λ μ΄μ–΄λ³„ μμ™Έ μ²λ¦¬
- **μ¬μ‹λ„ λ΅μ§**: λ„¤νΈμ›ν¬ μ¤λ¥ λ€μ‘
- **λ¨λ‹ν„°λ§**: μƒμ„Έν• λ΅κΉ… λ° λ©”νΈλ¦­

### 4. μ„±λ¥
- **λ°°μΉ μ²λ¦¬**: λ€λ‰ λ¬Έμ„ ν¨μ¨μ  μ²λ¦¬
- **λΉ„λ™κΈ° μ²λ¦¬**: FastAPI λΉ„λ™κΈ° μ§€μ›
- **μΊμ‹±**: μ„λ² λ”© κ²°κ³Ό μΊμ‹±

## π”— κ΄€λ ¨ λ¬Έμ„

- [μ‹μ¤ν… μ„¤κ³„](02_system_design.md)
- [μ„¤μ • κ°€μ΄λ“](03_configuration_guide.md)
- [μ΄λ©”μΌ μ‹μ¤ν…](05_email_system_guide.md)
- [κ°λ°μ κ°€μ΄λ“](10_development_guide.md)

---

**μ‘μ„±μΌ**: 2025-05-29  
**λ²„μ „**: 1.0  
**μƒνƒ**: ν™μ„±
